{% extends 'vacancies.html.twig' %}

{% block title %}Auditions{% endblock %}
{% set current_vacancies_id='auditions' %}

{% block vacancies_header %}
    <h3>Auditions</h3>

    <ul role="navigation">
        <li><i class="fa fa-list"></i> List view</li>
        <li><a href="{{ path('get_auditions_diary') }}"><i class="fa fa-calendar"></i> Diary View</a></li>
        <li><a href="{{ path('get_auditions_diary', {_format: 'ics'}) }}"><i class="fa fa-calendar"></i> iCal</a></li>
        <li><a href="{{ path('get_auditions', {_format: 'rss'}) }}"><i class="fa fa-rss"></i> RSS Feed</a></li>
        <li><a href="{{ path('get_auditions', {_format: 'txt'}) }}"><i class="fa fa-file-text-o"></i> Plain Text</a></li>
    </ul>
{% endblock %}

{% block vacancies_body %}
    {% spaceless %}
    {% set currentName = null %}
    {% for a in auditions %}
        {% if a.show %}
            {% if currentName != a.show.name %}
                {% if currentName is not empty %}
                    </ul>
                    </div>
                {% endif %}
                {% set currentName = a.show.name %}
                <hr>
                <div id="{{ a.show.slug }}">
                    {% include 'show/advert_header.html.twig' with
                        {'show': a.show} %}
                    <p>{{ a.show.audextra | camdram_markdown }}</p>
                    <ul>
            {% endif %}
            {% if a.nonscheduled %}
	            </ul>
                <p>Contact {{ a.location|detect_links }} before {{a.dateString}} for more details.</p>
	            </div>
		    {% set currentName = null %}
            {% else %}
                <li>{{ a.dateString }}, {{ a.location }}</li>
            {% endif %}
        {% endif %}
    {% else %}
        <p>There are currently no auditions listed - please check again later.</p>
    {% endfor %}
    </ul>
    {% endspaceless %}

{% endblock %}
